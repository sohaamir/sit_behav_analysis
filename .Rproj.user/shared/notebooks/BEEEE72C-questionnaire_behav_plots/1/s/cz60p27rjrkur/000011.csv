"0",""
"0","# Function to create plots for significant relationships"
"0","plot_relationship <- function(questionnaire, measure = ""choice"") {"
"0","  if(measure == ""choice"") {"
"0","    y_var <- ""choice_accuracy_diff"""
"0","    y_lab <- ""Choice accuracy difference (%)"""
"0","    fill_color <- ""#1f77b4"""
"0","  } else {"
"0","    y_var <- ""bet_magnitude_diff"""
"0","    y_lab <- ""Bet magnitude difference"""
"0","    fill_color <- ""#2ca02c"""
"0","  }"
"0","  "
"0","  p <- ggplot(participant_data, "
"0","              aes(x = .data[[questionnaire]], y = .data[[y_var]])) +"
"0","    geom_point() +"
"0","    geom_smooth(method = ""lm"", color = fill_color) +"
"0","    labs("
"0","      x = questionnaire,"
"0","      y = y_lab,"
"0","      title = paste(""Effect of"", questionnaire, ""on"", measure),"
"0","      subtitle = sprintf("
"0","        ""r = %.3f, p = %.3f"","
"0","        results$choice_r[results$questionnaire == questionnaire],"
"0","        results$choice_p[results$questionnaire == questionnaire]"
"0","      )"
"0","    ) +"
"0","    theme_classic()"
"0","  "
"0","  print(p)"
"0","}"
"0",""
"0","# Create plots for significant relationships (change p-values accordingly: 0.5 for testing, 0.05 for actual data)"
"0","significant_choice <- results %>% "
"0","  filter(choice_p_adj < 0.5) %>% "
"0","  pull(questionnaire)"
"0",""
"0","significant_bet <- results %>% "
"0","  filter(bet_p_adj < 0.5) %>% "
"0","  pull(questionnaire)"
"0",""
"0","# Plot significant relationships"
"0","for(quest in significant_choice) {"
"0","  plot_relationship(quest, ""choice"")"
"0","}"
